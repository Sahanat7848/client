<div class="mission-manager-container">
    <div class="header-actions">
        <button mat-raised-button color="primary" (click)="openDialog()">
            <mat-icon>add</mat-icon> Add Mission
        </button>
    </div>

    <div class="example-container mat-elevation-z8">
        @if (isLoadingResults || isRateLimitReached) {
        <div class="example-loading-shade">
            @if (isLoadingResults) {
            <mat-spinner></mat-spinner>
            }
            @if (isRateLimitReached) {
            <div class="example-rate-limit-reached">
                Unable to fetch missions. Please try again later.
            </div>
            }
        </div>
        }

        <div class="example-table-container">
            <table mat-table [dataSource]="dataSource" class="example-table" matSort matSortActive="created_at"
                matSortDisableClear matSortDirection="desc">

                <!-- Name Column -->
                <ng-container matColumnDef="name">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
                    <td mat-cell *matCellDef="let row">{{row.name}}</td>
                </ng-container>

                <!-- Description Column -->
                <ng-container matColumnDef="description">
                    <th mat-header-cell *matHeaderCellDef>Description</th>
                    <td mat-cell *matCellDef="let row">{{row.description}}</td>
                </ng-container>

                <!-- Status Column -->
                <ng-container matColumnDef="status">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header>Status</th>
                    <td mat-cell *matCellDef="let row">
                        <span class="status-badge" [ngClass]="row.status">{{row.status}}</span>
                    </td>
                </ng-container>

                <!-- Chief ID Column -->
                <ng-container matColumnDef="chief_id">
                    <th mat-header-cell *matHeaderCellDef>Chief ID</th>
                    <td mat-cell *matCellDef="let row">{{row.chief_id}}</td>
                </ng-container>

                <!-- Crew Count Column -->
                <ng-container matColumnDef="crew_count">
                    <th mat-header-cell *matHeaderCellDef>Crew</th>
                    <td mat-cell *matCellDef="let row">{{row.crew_count}}</td>
                </ng-container>

                <!-- Created Column -->
                <ng-container matColumnDef="created_at">
                    <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear>
                        Created
                    </th>
                    <td mat-cell *matCellDef="let row">{{row.created_at | date:'short'}}</td>
                </ng-container>

                <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
                <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
            </table>
        </div>

        <mat-paginator [length]="resultsLength" [pageSize]="10" [pageSizeOptions]="[5, 10, 25, 100]"
            aria-label="Select page of missions"></mat-paginator>
    </div>
</div>